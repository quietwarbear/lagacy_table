{
	"info": {
		"_postman_id": "htrecipes-api-collection",
		"name": "HTrecipes API Collection",
		"description": "Complete API collection for Honor Touré Family Recipe App",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Register",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"password\": \"password123\",\n  \"nickname\": \"Johnny\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/register",
							"host": ["{{base_url}}"],
							"path": ["api", "auth", "register"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.environment.set(\"auth_token\", jsonData.token);",
									"    pm.environment.set(\"user_id\", jsonData.user.id);",
									"    pm.environment.set(\"user_family_id\", jsonData.user.family_id || \"\");",
									"    pm.environment.set(\"user_role\", jsonData.user.role || \"\");",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Login",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email\": \"john@example.com\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/login",
							"host": ["{{base_url}}"],
							"path": ["api", "auth", "login"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.environment.set(\"auth_token\", jsonData.token);",
									"    pm.environment.set(\"user_id\", jsonData.user.id);",
									"    pm.environment.set(\"user_family_id\", jsonData.user.family_id || \"\");",
									"    pm.environment.set(\"user_role\", jsonData.user.role || \"\");",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Get Current User",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/auth/me",
							"host": ["{{base_url}}"],
							"path": ["api", "auth", "me"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.environment.set(\"user_family_id\", jsonData.family_id || \"\");",
									"    pm.environment.set(\"user_role\", jsonData.role || \"\");",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Update Profile",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"nickname\": \"Updated Nickname\",\n  \"avatar\": \"base64_encoded_image_data\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/auth/profile",
							"host": ["{{base_url}}"],
							"path": ["api", "auth", "profile"]
						}
					}
				}
			]
		},
		{
			"name": "Recipes",
			"item": [
				{
					"name": "Create Recipe",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"Delicious Pasta\",\n  \"ingredients\": [\"pasta\", \"tomato sauce\", \"cheese\"],\n  \"instructions\": \"Cook pasta and add sauce\",\n  \"story\": \"A family favorite recipe\",\n  \"photos\": [],\n  \"cooking_time\": 30,\n  \"servings\": 4,\n  \"category\": \"Main Course\",\n  \"difficulty\": \"easy\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/recipes",
							"host": ["{{base_url}}"],
							"path": ["api", "recipes"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.environment.set(\"recipe_id\", jsonData.id);",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Get All Recipes",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/recipes?category=Main Course&author_id={{user_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "recipes"],
							"query": [
								{
									"key": "category",
									"value": "Main Course",
									"disabled": true
								},
								{
									"key": "author_id",
									"value": "{{user_id}}",
									"disabled": true
								}
							]
						}
					}
				},
				{
					"name": "Get Recipe by ID",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/recipes/{{recipe_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "recipes", "{{recipe_id}}"]
						}
					}
				},
				{
					"name": "Update Recipe",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"Updated Recipe Title\",\n  \"cooking_time\": 45\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/recipes/{{recipe_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "recipes", "{{recipe_id}}"]
						}
					}
				},
				{
					"name": "Delete Recipe",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/recipes/{{recipe_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "recipes", "{{recipe_id}}"]
						}
					}
				},
				{
					"name": "Get Categories",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/categories",
							"host": ["{{base_url}}"],
							"path": ["api", "categories"]
						}
					}
				}
			]
		},
		{
			"name": "Comments",
			"item": [
				{
					"name": "Create Comment",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"text\": \"This recipe looks amazing!\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/recipes/{{recipe_id}}/comments",
							"host": ["{{base_url}}"],
							"path": ["api", "recipes", "{{recipe_id}}", "comments"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.environment.set(\"comment_id\", jsonData.id);",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Get Comments",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/recipes/{{recipe_id}}/comments",
							"host": ["{{base_url}}"],
							"path": ["api", "recipes", "{{recipe_id}}", "comments"]
						}
					}
				},
				{
					"name": "Delete Comment",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/comments/{{comment_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "comments", "{{comment_id}}"]
						}
					}
				}
			]
		},
		{
			"name": "Notifications",
			"item": [
				{
					"name": "Get Notifications",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/notifications",
							"host": ["{{base_url}}"],
							"path": ["api", "notifications"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.length > 0) {",
									"        pm.environment.set(\"notification_id\", jsonData[0].id);",
									"    }",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Get Unread Count",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/notifications/unread-count",
							"host": ["{{base_url}}"],
							"path": ["api", "notifications", "unread-count"]
						}
					}
				},
				{
					"name": "Mark Notification as Read",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/notifications/{{notification_id}}/read",
							"host": ["{{base_url}}"],
							"path": ["api", "notifications", "{{notification_id}}", "read"]
						}
					}
				},
				{
					"name": "Mark All Notifications as Read",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/notifications/read-all",
							"host": ["{{base_url}}"],
							"path": ["api", "notifications", "read-all"]
						}
					}
				}
			]
		},
		{
			"name": "Families",
			"item": [
				{
					"name": "Create Family",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Touré Family\",\n  \"description\": \"Our family recipe collection\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/families",
							"host": ["{{base_url}}"],
							"path": ["api", "families"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.environment.set(\"family_id\", jsonData.id);",
									"    pm.environment.set(\"invite_code\", jsonData.invite_code);",
									"    pm.environment.set(\"user_family_id\", jsonData.id);",
									"    pm.environment.set(\"user_role\", \"keeper\");",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Join Family",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"invite_code\": \"{{invite_code}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/families/join",
							"host": ["{{base_url}}"],
							"path": ["api", "families", "join"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.environment.set(\"family_id\", jsonData.id);",
									"    pm.environment.set(\"user_family_id\", jsonData.id);",
									"    pm.environment.set(\"user_role\", \"member\");",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Get Family Details",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/families/{{family_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "families", "{{family_id}}"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    pm.environment.set(\"invite_code\", jsonData.invite_code);",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Update Family",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Updated Family Name\",\n  \"description\": \"Updated description\",\n  \"cover_image\": \"base64_encoded_image\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/families/{{family_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "families", "{{family_id}}"]
						}
					}
				},
				{
					"name": "Delete Family",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/families/{{family_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "families", "{{family_id}}"]
						}
					}
				},
				{
					"name": "Get Family Members",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/families/{{family_id}}/members",
							"host": ["{{base_url}}"],
							"path": ["api", "families", "{{family_id}}", "members"]
						}
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    // Find a member that is not the current user to use for transfer keeper test",
									"    const otherMember = jsonData.find(m => m.id !== pm.environment.get(\"user_id\"));",
									"    if (otherMember) {",
									"        pm.environment.set(\"new_keeper_id\", otherMember.id);",
									"    }",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Remove Family Member",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/families/{{family_id}}/members/{{user_id}}",
							"host": ["{{base_url}}"],
							"path": ["api", "families", "{{family_id}}", "members", "{{user_id}}"]
						},
						"description": "Only the Keeper can remove members. Replace {{user_id}} with the ID of the member to remove."
					}
				},
				{
					"name": "Leave Family",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/families/{{family_id}}/leave",
							"host": ["{{base_url}}"],
							"path": ["api", "families", "{{family_id}}", "leave"]
						},
						"description": "Allows a member to leave the family. Regular members can leave immediately. Keeper can only leave if they are the only member, or after transferring keeper role."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    pm.environment.set(\"user_family_id\", \"\");",
									"    pm.environment.set(\"user_role\", \"\");",
									"}"
								]
							}
						}
					]
				},
				{
					"name": "Transfer Keeper Role",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Bearer {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"new_keeper_id\": \"{{new_keeper_id}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/families/{{family_id}}/transfer-keeper",
							"host": ["{{base_url}}"],
							"path": ["api", "families", "{{family_id}}", "transfer-keeper"]
						},
						"description": "Transfers the keeper role from the current keeper to another member. Only the current keeper can transfer their role. Replace {{new_keeper_id}} with the ID of the member who should become the new keeper."
					},
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    pm.environment.set(\"user_role\", \"member\");",
									"}"
								]
							}
						}
					]
				}
			]
		},
		{
			"name": "Health Check",
			"item": [
				{
					"name": "Root",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/",
							"host": ["{{base_url}}"],
							"path": ["api", ""]
						}
					}
				},
				{
					"name": "Health",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/health",
							"host": ["{{base_url}}"],
							"path": ["api", "health"]
						}
					}
				}
			]
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000",
			"type": "string"
		}
	]
}
